{"numFailedTestSuites":1,"numFailedTests":37,"numPassedTestSuites":9,"numPassedTests":144,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":10,"numTotalTests":181,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1761339013021,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["auditoriaService"],"duration":64,"failureDetails":[],"failureMessages":[],"fullName":"auditoriaService insere registro com detalhes objeto removendo cargo vazio","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"insere registro com detalhes objeto removendo cargo vazio"},{"ancestorTitles":["auditoriaService"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"auditoriaService insere com detalhes string, ip de connection e url fallback","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"insere com detalhes string, ip de connection e url fallback"},{"ancestorTitles":["auditoriaService"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"auditoriaService não lança quando query falha e registra erro","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"não lança quando query falha e registra erro"}],"endTime":1761339021245,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\auditoriaService.test.js","startTime":1761339015285,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["acessosService","listAcessos"],"duration":73,"failureDetails":[],"failureMessages":[],"fullName":"acessosService listAcessos retorna linhas do banco para o processo informado","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna linhas do banco para o processo informado"},{"ancestorTitles":["acessosService","addAcesso"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso valida tipo inválido e lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida tipo inválido e lança erro 400"},{"ancestorTitles":["acessosService","addAcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso tipo vazio ou undefined lança erro 400 com mensagem específica","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"tipo vazio ou undefined lança erro 400 com mensagem específica"},{"ancestorTitles":["acessosService","addAcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso SETOR sem valor lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"SETOR sem valor lança erro 400"},{"ancestorTitles":["acessosService","addAcesso"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso USUARIO sem valor lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"USUARIO sem valor lança erro 400"},{"ancestorTitles":["acessosService","addAcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso retorna id ao adicionar acesso USUARIO com processo existente","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"retorna id ao adicionar acesso USUARIO com processo existente"},{"ancestorTitles":["acessosService","addAcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"acessosService addAcesso lança 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando processo não existe"},{"ancestorTitles":["acessosService","removeAcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"acessosService removeAcesso deleta e retorna ok: true quando encontrado","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deleta e retorna ok: true quando encontrado"},{"ancestorTitles":["acessosService","removeAcesso"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"acessosService removeAcesso lança 404 quando não encontra o acesso","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando não encontra o acesso"}],"endTime":1761339021448,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\acessosService.test.js","startTime":1761339015507,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["arquivar"],"duration":70,"failureDetails":[],"failureMessages":[],"fullName":"arquivar valida usuário obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida usuário obrigatório"},{"ancestorTitles":["arquivar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"arquivar retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["arquivar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"arquivar retorna 400 quando processo está pendente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando processo está pendente"},{"ancestorTitles":["arquivar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"arquivar retorna 400 quando processo já está arquivado","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando processo já está arquivado"},{"ancestorTitles":["arquivar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"arquivar retorna 403 quando não atribuído ao usuário","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando não atribuído ao usuário"},{"ancestorTitles":["arquivar"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"arquivar arquiva com sucesso","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"arquiva com sucesso"}],"endTime":1761339021470,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\arquivar.test.js","startTime":1761339015195,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["catalogService","listSetores"],"duration":66,"failureDetails":[],"failureMessages":[],"fullName":"catalogService listSetores retorna sigla e nome de setores em ordem","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna sigla e nome de setores em ordem"},{"ancestorTitles":["catalogService","listAssuntos"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"catalogService listAssuntos retorna id e nome de assuntos em ordem","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna id e nome de assuntos em ordem"},{"ancestorTitles":["catalogService","listTiposProcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"catalogService listTiposProcesso retorna id e nome de tipos de processo em ordem","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna id e nome de tipos de processo em ordem"}],"endTime":1761339021545,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\catalogService.test.js","startTime":1761339015480,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["chavesService","listChaves"],"duration":71,"failureDetails":[],"failureMessages":[],"fullName":"chavesService listChaves retorna linhas do banco para o processo informado","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna linhas do banco para o processo informado"},{"ancestorTitles":["chavesService","createChave"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"chavesService createChave valida parteId ausente e lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida parteId ausente e lança erro 400"},{"ancestorTitles":["chavesService","createChave"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"chavesService createChave lança 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando processo não existe"},{"ancestorTitles":["chavesService","createChave"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"chavesService createChave lança 404 quando parte não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando parte não existe"},{"ancestorTitles":["chavesService","createChave"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"chavesService createChave cria chave e retorna id e chave","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"cria chave e retorna id e chave"},{"ancestorTitles":["chavesService","revokeChave"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"chavesService revokeChave revoga chave quando encontrada","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"revoga chave quando encontrada"},{"ancestorTitles":["chavesService","revokeChave"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"chavesService revokeChave lança 404 quando não encontra a chave","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando não encontra a chave"}],"endTime":1761339021582,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\chavesService.test.js","startTime":1761339015537,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["partesCadastroService","listarPartesCadastro"],"duration":76,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService listarPartesCadastro lista com filtro q, limit e offset","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"lista com filtro q, limit e offset"},{"ancestorTitles":["partesCadastroService","listarPartesCadastro"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService listarPartesCadastro lista sem filtro q (defaults limit=50, offset=0)","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"lista sem filtro q (defaults limit=50, offset=0)"},{"ancestorTitles":["partesCadastroService","obterParteCadastro"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService obterParteCadastro retorna registro por id","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"retorna registro por id"},{"ancestorTitles":["partesCadastroService","criarParteCadastro"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService criarParteCadastro insere com id gerado e normaliza UF","invocations":1,"location":null,"numPassingAsserts":17,"retryReasons":[],"status":"passed","title":"insere com id gerado e normaliza UF"},{"ancestorTitles":["partesCadastroService","atualizarParteCadastro"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService atualizarParteCadastro atualiza com ordem fixa e normaliza UF","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"atualiza com ordem fixa e normaliza UF"},{"ancestorTitles":["partesCadastroService","removerParteCadastro"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService removerParteCadastro bloqueia exclusão quando há vínculo em processo_partes pelo cadastro_parte_id","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"bloqueia exclusão quando há vínculo em processo_partes pelo cadastro_parte_id"},{"ancestorTitles":["partesCadastroService","removerParteCadastro"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService removerParteCadastro exclui quando não há vínculo e retorna ok","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"exclui quando não há vínculo e retorna ok"},{"ancestorTitles":["partesCadastroService","removerParteCadastro"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"partesCadastroService removerParteCadastro exclui quando SELECT retorna objeto sem rows (links.rows indefinido)","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"exclui quando SELECT retorna objeto sem rows (links.rows indefinido)"}],"endTime":1761339021605,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\partesCadastroService.test.js","startTime":1761339015513,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["usuariosService","getUsuarios"],"duration":56,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios retorna usuário por login quando encontrado","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna usuário por login quando encontrado"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios retorna null por login quando não encontrado","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna null por login quando não encontrado"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios lista usuários filtrando por setor quando informado","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"lista usuários filtrando por setor quando informado"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios lista usuários filtrando por sigla de setor quando informado","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"lista usuários filtrando por sigla de setor quando informado"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios retorna lista vazia quando sigla vazia ou indefinida","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna lista vazia quando sigla vazia ou indefinida"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios lista usuários sem filtro quando setor não informado","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"lista usuários sem filtro quando setor não informado"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios ignora login vazio e lista usuários sem filtro","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"ignora login vazio e lista usuários sem filtro"},{"ancestorTitles":["usuariosService","getUsuarios"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService getUsuarios ignora login vazio e aplica filtro por setor quando presente","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"ignora login vazio e aplica filtro por setor quando presente"},{"ancestorTitles":["usuariosService","upsertUsuario"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService upsertUsuario valida login e nome obrigatórios (400)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida login e nome obrigatórios (400)"},{"ancestorTitles":["usuariosService","upsertUsuario"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService upsertUsuario faz update quando usuário já existe e retorna usuario.upsert","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"faz update quando usuário já existe e retorna usuario.upsert"},{"ancestorTitles":["usuariosService","upsertUsuario"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService upsertUsuario faz insert quando usuário não existe e retorna usuario.criar","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"faz insert quando usuário não existe e retorna usuario.criar"},{"ancestorTitles":["usuariosService coverage add-ons","upsertUsuario updates"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService coverage add-ons upsertUsuario updates atualiza nome, setor e cargo quando ambos informados","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"atualiza nome, setor e cargo quando ambos informados"},{"ancestorTitles":["usuariosService coverage add-ons","upsertUsuario updates"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService coverage add-ons upsertUsuario updates atualiza nome e setor quando cargo omitido","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"atualiza nome e setor quando cargo omitido"},{"ancestorTitles":["usuariosService coverage add-ons","upsertUsuario updates"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService coverage add-ons upsertUsuario updates atualiza nome e cargo quando setor omitido","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"atualiza nome e cargo quando setor omitido"},{"ancestorTitles":["usuariosService coverage add-ons","upsertUsuario insert defaults"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService coverage add-ons upsertUsuario insert defaults insere com setor PROTOCOLO e cargo null quando omitidos","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"insere com setor PROTOCOLO e cargo null quando omitidos"},{"ancestorTitles":["usuariosService coverage add-ons","getUsuariosPorSigla lower-case input"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"usuariosService coverage add-ons getUsuariosPorSigla lower-case input aplica UPPER na sigla recebida","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"aplica UPPER na sigla recebida"}],"endTime":1761339021605,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\usuariosService.test.js","startTime":1761339015593,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["transacoesService"],"duration":57,"failureDetails":[],"failureMessages":[],"fullName":"transacoesService beginTransaction chama BEGIN uma vez","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"beginTransaction chama BEGIN uma vez"},{"ancestorTitles":["transacoesService"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"transacoesService commitTransaction chama COMMIT uma vez","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"commitTransaction chama COMMIT uma vez"},{"ancestorTitles":["transacoesService"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"transacoesService rollback chama ROLLBACK e resolve no sucesso","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"rollback chama ROLLBACK e resolve no sucesso"},{"ancestorTitles":["transacoesService"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"transacoesService rollback engole o erro quando ROLLBACK falha","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"rollback engole o erro quando ROLLBACK falha"}],"endTime":1761339021697,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\transacoesService.test.js","startTime":1761339015522,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["processosService","getProcessoById"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"processosService getProcessoById retorna null quando processo não encontrado","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna null quando processo não encontrado"},{"ancestorTitles":["processosService","getProcessoById"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"processosService getProcessoById retorna processo com partes","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"retorna processo com partes"},{"ancestorTitles":["processosService","createProcesso"],"duration":204,"failureDetails":[],"failureMessages":[],"fullName":"processosService createProcesso exige assunto obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"exige assunto obrigatório"},{"ancestorTitles":["processosService","createProcesso"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService createProcesso exige base legal quando nivelAcesso não é Público","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"exige base legal quando nivelAcesso não é Público"},{"ancestorTitles":["processosService","createProcesso"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"processosService createProcesso cria processo com defaults, insere partes e documentos, e retorna view","invocations":1,"location":null,"numPassingAsserts":33,"retryReasons":[],"status":"passed","title":"cria processo com defaults, insere partes e documentos, e retorna view"},{"ancestorTitles":["processosService","createProcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService createProcesso retorna 404 quando partes inclui parteId inexistente","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"retorna 404 quando partes inclui parteId inexistente"},{"ancestorTitles":["processosService","createProcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService createProcesso vincula parte existente via parteId sem criar cadastro","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"vincula parte existente via parteId sem criar cadastro"},{"ancestorTitles":["processosService","updateDados"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService updateDados retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","updateDados"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService updateDados valida base legal quando nivelAcesso diferente de Público","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida base legal quando nivelAcesso diferente de Público"},{"ancestorTitles":["processosService","updateDados"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"processosService updateDados atualiza dados e retorna o processo atualizado","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"atualiza dados e retorna o processo atualizado"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir valida usuário e executor obrigatórios","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"valida usuário e executor obrigatórios"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 403 quando processo não está atribuído ao executor","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando processo não está atribuído ao executor"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 400 quando usuário destino não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando usuário destino não existe"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 400 quando setor do usuário destino difere do setor atual","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando setor do usuário destino difere do setor atual"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir atribui com sucesso e retorna processo e detalhes","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"atribui com sucesso e retorna processo e detalhes"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 403 quando processo restrito e destino não possui acesso","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando processo restrito e destino não possui acesso"},{"ancestorTitles":["processosService","atribuir"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService atribuir retorna 404 quando UPDATE não afeta nenhuma linha","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando UPDATE não afeta nenhuma linha"},{"ancestorTitles":["processosService","consultarPublico"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna 404 quando processo não encontrado pelo número","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não encontrado pelo número"},{"ancestorTitles":["processosService","consultarPublico"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna 403 quando restrito sem chave","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando restrito sem chave"},{"ancestorTitles":["processosService","consultarPublico"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna dados públicos quando processo é público (por número)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna dados públicos quando processo é público (por número)"},{"ancestorTitles":["processosService","consultarPublico"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico busca por UUID quando valor é UUID","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"busca por UUID quando valor é UUID"},{"ancestorTitles":["processosService","tramitar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar valida usuário executor obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida usuário executor obrigatório"},{"ancestorTitles":["processosService","tramitar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","tramitar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar retorna 403 quando processo não está atribuído ao executor","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando processo não está atribuído ao executor"},{"ancestorTitles":["processosService","tramitar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar tramita com sucesso e retorna processo e detalhes","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"tramita com sucesso e retorna processo e detalhes"},{"ancestorTitles":["processosService","tramitar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar tramita alterando somente prazo e mantém prioridade original","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"tramita alterando somente prazo e mantém prioridade original"},{"ancestorTitles":["processosService","tramitar"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"processosService tramitar tramita sem motivo e prazo, com prioridade definida","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"tramita sem motivo e prazo, com prioridade definida"},{"ancestorTitles":["processosService","listProcessos"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"processosService listProcessos retorna total, page e items com paginação, sem filtros","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"status":"passed","title":"retorna total, page e items com paginação, sem filtros"},{"ancestorTitles":["processosService","listProcessos"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService listProcessos aplica filtros de numero, assunto e interessado","invocations":1,"location":null,"numPassingAsserts":14,"retryReasons":[],"status":"passed","title":"aplica filtros de numero, assunto e interessado"},{"ancestorTitles":["processosService","listProcessos"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService listProcessos aplica filtros de status, prioridade, nivelAcesso e setor","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"status":"passed","title":"aplica filtros de status, prioridade, nivelAcesso e setor"},{"ancestorTitles":["processosService","listProcessos"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService listProcessos aplica pendente, pendenteSetor e somenteMeus com usuario","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"aplica pendente, pendenteSetor e somenteMeus com usuario"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte valida nome obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida nome obrigatório"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte cria parte e retorna dados","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"cria parte e retorna dados"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte retorna 404 quando parteId inexiste no cadastro","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando parteId inexiste no cadastro"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte retorna 404 quando processo não existe via parteId","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe via parteId"},{"ancestorTitles":["processosService","addParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte vincula cadastro existente via parteId sem inserir novo cadastro","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"vincula cadastro existente via parteId sem inserir novo cadastro"},{"ancestorTitles":["processosService","addParte","deleteParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte deleteParte retorna 404 quando parte não encontrada no processo","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna 404 quando parte não encontrada no processo"},{"ancestorTitles":["processosService","addParte","deleteParte"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService addParte deleteParte deleta parte e retorna nome","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"deleta parte e retorna nome"},{"ancestorTitles":["processosService","consultarPublico"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna 404 quando processo não encontrado pelo número","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não encontrado pelo número"},{"ancestorTitles":["processosService","consultarPublico"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna 403 quando restrito sem chave","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando restrito sem chave"},{"ancestorTitles":["processosService","consultarPublico"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna 403 quando CPF/chave inválidos","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna 403 quando CPF/chave inválidos"},{"ancestorTitles":["processosService","consultarPublico"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna dados públicos quando restrito com chave válida","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"retorna dados públicos quando restrito com chave válida"},{"ancestorTitles":["processosService","consultarPublico"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico retorna dados públicos quando processo é público (por número)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna dados públicos quando processo é público (por número)"},{"ancestorTitles":["processosService","consultarPublico"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"processosService consultarPublico busca por UUID quando valor é UUID","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"busca por UUID quando valor é UUID"},{"ancestorTitles":["processosService","listTramites"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService listTramites retorna lista de trâmites para um processo","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"retorna lista de trâmites para um processo"},{"ancestorTitles":["processosService","listTramites"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService listTramites retorna lista vazia quando não há trâmites","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna lista vazia quando não há trâmites"},{"ancestorTitles":["processosService","priorizar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService priorizar valida prioridade e executor obrigatórios","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"valida prioridade e executor obrigatórios"},{"ancestorTitles":["processosService","priorizar"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"processosService priorizar retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","priorizar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService priorizar retorna 403 quando processo está atribuído a outro usuário","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando processo está atribuído a outro usuário"},{"ancestorTitles":["processosService","priorizar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService priorizar prioriza com sucesso e retorna processo e detalhes","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"prioriza com sucesso e retorna processo e detalhes"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia valida usuário obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida usuário obrigatório"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia retorna 400 quando processo não está pendente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando processo não está pendente"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia retorna 400 quando usuário não encontrado","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando usuário não encontrado"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia retorna 403 quando usuário não pertence ao setor destino","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando usuário não pertence ao setor destino"},{"ancestorTitles":["processosService","aceitarPendencia"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService aceitarPendencia aceita pendência com sucesso e retorna processo e detalhes","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"aceita pendência com sucesso e retorna processo e detalhes"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia valida usuário e motivo obrigatórios","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"valida usuário e motivo obrigatórios"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia retorna 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 404 quando processo não existe"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia retorna 400 quando processo não está pendente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando processo não está pendente"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia retorna 400 quando usuário não encontrado","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 quando usuário não encontrado"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia retorna 403 quando usuário não pertence ao setor destino","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando usuário não pertence ao setor destino"},{"ancestorTitles":["processosService","recusarPendencia"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"processosService recusarPendencia recusa pendência com sucesso e retorna processo e detalhes","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"recusa pendência com sucesso e retorna processo e detalhes"}],"endTime":1761339021750,"message":"","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\processosService.test.js","startTime":1761339015405,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["documentosService","listByProcesso"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"documentosService listByProcesso erro 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"erro 404 quando processo não existe"},{"ancestorTitles":["documentosService","listByProcesso"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService listByProcesso lista documentos assinados quando viewerSetor ausente","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"lista documentos assinados quando viewerSetor ausente"},{"ancestorTitles":["documentosService","listByProcesso"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"documentosService listByProcesso lista documentos considerando setor do viewer quando informado","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"lista documentos considerando setor do viewer quando informado"},{"ancestorTitles":["documentosService","linkDocumento"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService linkDocumento valida documentoId obrigatório e lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida documentoId obrigatório e lança erro 400"},{"ancestorTitles":["documentosService","linkDocumento"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"documentosService linkDocumento lança 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando processo não existe"},{"ancestorTitles":["documentosService","linkDocumento"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"documentosService linkDocumento lança 404 quando documento não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando documento não existe"},{"ancestorTitles":["documentosService","linkDocumento"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService linkDocumento insere link e retorna ok: true","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"insere link e retorna ok: true"},{"ancestorTitles":["documentosService","createDocumento"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService createDocumento valida título obrigatório e lança erro 400","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida título obrigatório e lança erro 400"},{"ancestorTitles":["documentosService","createDocumento"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService createDocumento cria documento rascunho e retorna dados do SELECT","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"cria documento rascunho e retorna dados do SELECT"},{"ancestorTitles":["documentosService","getDocumentoById"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService getDocumentoById retorna null quando não encontra","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna null quando não encontra"},{"ancestorTitles":["documentosService","getDocumentoById"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService getDocumentoById retorna objeto com campos mapeados quando encontra","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"retorna objeto com campos mapeados quando encontra"},{"ancestorTitles":["documentosService","assinar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService assinar valida usuário executor obrigatório","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"valida usuário executor obrigatório"},{"ancestorTitles":["documentosService","assinar"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"documentosService assinar lança 404 quando documento não existe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 404 quando documento não existe"},{"ancestorTitles":["documentosService","assinar"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"documentosService assinar lança 400 quando modo não é Editor nem Upload","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"lança 400 quando modo não é Editor nem Upload"},{"ancestorTitles":["documentosService","assinar"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService assinar assina documento de Upload válido e retorna documento","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"assina documento de Upload válido e retorna documento"},{"ancestorTitles":["documentosService","deletarRascunho"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService deletarRascunho impede excluir documento assinado (erro 400)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"impede excluir documento assinado (erro 400)"},{"ancestorTitles":["documentosService","deletarRascunho"],"duration":1,"failureDetails":[{"code":403}],"failureMessages":["Error: Você só pode excluir documentos criados por você\n    at Object.deletarRascunho (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:371:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:222:22)"],"fullName":"documentosService deletarRascunho exclui rascunho criado pelo usuário e retorna ok","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"exclui rascunho criado pelo usuário e retorna ok"},{"ancestorTitles":["gerarPdfPublico"],"duration":12,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:242:72)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico retorna 404 quando documento não existe","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 404 quando documento não existe"},{"ancestorTitles":["gerarPdfPublico"],"duration":3,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:251:70)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico retorna 403 quando documento não assinado","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 403 quando documento não assinado"},{"ancestorTitles":["gerarPdfPublico"],"duration":3,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 404,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 404,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 404,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:259:78)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico processo não público sem CPF+chave retorna 403","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"processo não público sem CPF+chave retorna 403"},{"ancestorTitles":["gerarPdfPublico"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m2\u001b[39m\nReceived number of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m2\u001b[39m\nReceived number of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledTimes (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:270:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico CPF/chave inválidos retornam 403","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"CPF/chave inválidos retornam 403"},{"ancestorTitles":["gerarPdfPublico"],"duration":0,"failureDetails":[{"code":403}],"failureMessages":["Error: Documento pertence a processo não público: CPF e chave são obrigatórios\n    at Object.gerarPdfPublico (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:422:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:280:20)"],"fullName":"gerarPdfPublico upload PDF retorna conteúdo base64 e fileName do arquivo","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"upload PDF retorna conteúdo base64 e fileName do arquivo"},{"ancestorTitles":["gerarPdfPublico"],"duration":0,"failureDetails":[{"code":403}],"failureMessages":["Error: Documento pertence a processo não público: CPF e chave são obrigatórios\n    at Object.gerarPdfPublico (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:422:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:291:20)"],"fullName":"gerarPdfPublico editor gera PDF via puppeteer e retorna base64","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"editor gera PDF via puppeteer e retorna base64"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":0,"failureDetails":[{"code":404}],"failureMessages":["Error: Documento não encontrado\n    at Object.gerarPdfPublico (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:409:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:309:20)"],"fullName":"gerarPdfPublico adicionais gera PDF no modo Editor com texto simples (sanitiza &<> e título)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"gera PDF no modo Editor com texto simples (sanitiza &<> e título)"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"arquivo.pdf","expected":"Imagem_PNG.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7marquivo\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7marquivo\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:324:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais gera PDF no modo Upload (imagem PNG)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"gera PDF no modo Upload (imagem PNG)"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":4,"failureDetails":[{"matcherResult":{"actual":"Meu_Doc.pdf","expected":"Imagem_WEBP.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mImagem_WEBP\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mMeu_Doc\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mImagem_WEBP\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mMeu_Doc\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:333:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais converte imagem WEBP para PDF no modo upload","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"converte imagem WEBP para PDF no modo upload"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":2,"failureDetails":[{"matcherResult":{"actual":"Doc_.pdf","expected":"Gr_fico_SVG.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mDoc_\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mDoc_\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:342:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais converte SVG para PDF no modo upload","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"converte SVG para PDF no modo upload"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":1,"failureDetails":[{"matcherResult":{"actual":"Imagem_PNG.pdf","expected":"doc.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:352:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais decodifica CSV de bytes quando upload PDF com base64 em CSV","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"decodifica CSV de bytes quando upload PDF com base64 em CSV"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":4,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"contentBase64\": \"UklGR\", \"fileName\": \"Imagem_WEBP.pdf\"}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"contentBase64\": \"UklGR\", \"fileName\": \"Imagem_WEBP.pdf\"}\u001b[39m\n    at expect (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:358:11)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico adicionais retorna 415 para modo não suportado","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 415 para modo não suportado"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":1,"failureDetails":[{"matcherResult":{"actual":"Gr_fico_SVG.pdf","expected":"HTML.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mHTML\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mHTML\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:385:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais gera PDF quando conteúdo já é HTML (usa diretamente)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"gera PDF quando conteúdo já é HTML (usa diretamente)"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":2,"failureDetails":[{"matcherResult":{"actual":"doc.pdf","expected":"Vazio.pdf","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mVazio\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mVazio\u001b[27m.pdf\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m\n    at Object.toBe (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:415:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"gerarPdfPublico adicionais gera PDF com template padrão quando conteúdo vazio (Editor)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"gera PDF com template padrão quando conteúdo vazio (Editor)"},{"ancestorTitles":["gerarPdfPublico adicionais"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 409,\u001b[39m\n\u001b[31m+   \"code\": 415,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 409,\u001b[39m\n\u001b[31m+   \"code\": 415,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 409,\u001b[39m\n\u001b[31m+   \"code\": 415,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:424:67)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico adicionais retorna 409 quando upload sem conteúdo base64","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 409 quando upload sem conteúdo base64"},{"ancestorTitles":["uploadConteudo adicionais"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"uploadConteudo adicionais exige usuarioLogin para documento assinado","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"exige usuarioLogin para documento assinado"},{"ancestorTitles":["uploadConteudo adicionais"],"duration":0,"failureDetails":[{"code":400}],"failureMessages":["Error: Processo não está atribuído a nenhum usuário\n    at _validarPosicaoFimArvore (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:111:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.uploadConteudo (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:178:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:456:20)"],"fullName":"uploadConteudo adicionais usa defaults e atualiza assinado → rascunho quando fim da árvore","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"usa defaults e atualiza assinado → rascunho quando fim da árvore"},{"ancestorTitles":["uploadConteudo adicionais"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:483:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"uploadConteudo adicionais retorna 404 quando UPDATE não afeta linhas","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 404 quando UPDATE não afeta linhas"},{"ancestorTitles":["uploadConteudo adicionais"],"duration":2,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"assinante\": null, \"ok\": true, \"statusAnterior\": \"\"}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"assinante\": null, \"ok\": true, \"statusAnterior\": \"\"}\u001b[39m\n    at expect (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:493:11)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"uploadConteudo adicionais lança 400 quando documento não está vinculado a processo (rascunho)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"lança 400 quando documento não está vinculado a processo (rascunho)"},{"ancestorTitles":["editorConteudo adicionais"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"editorConteudo adicionais exige usuarioLogin para rascunho","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"exige usuarioLogin para rascunho"},{"ancestorTitles":["editorConteudo adicionais"],"duration":18,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:530:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"editorConteudo adicionais retorna 404 quando UPDATE não afeta linhas","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 404 quando UPDATE não afeta linhas"},{"ancestorTitles":["assinar adicionais"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"assinar adicionais retorna 400 para Upload sem conteúdo","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 para Upload sem conteúdo"},{"ancestorTitles":["assinar adicionais"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"assinar adicionais retorna 400 para Upload com extensão inválida","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 400 para Upload com extensão inválida"},{"ancestorTitles":["assinar adicionais"],"duration":0,"failureDetails":[{"code":400}],"failureMessages":["Error: Apenas documentos do Editor ou Upload podem ser assinados\n    at Object.assinar (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:302:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:569:20)"],"fullName":"assinar adicionais assina com sucesso em modo Editor no fim da árvore","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"assina com sucesso em modo Editor no fim da árvore"},{"ancestorTitles":["assinar adicionais"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:591:90)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"assinar adicionais retorna 404 quando UPDATE não afeta linhas (Editor)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 404 quando UPDATE não afeta linhas (Editor)"},{"ancestorTitles":["gerarPdfPublico adicionais (upload extensão não suportada)"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 415,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 415,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 415,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:601:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"gerarPdfPublico adicionais (upload extensão não suportada) lança 415 no modo upload com extensão não suportada","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"lança 415 no modo upload com extensão não suportada"},{"ancestorTitles":["editorConteudo adicionais (regras de autorização)"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 403,\u001b[39m\n\u001b[31m+   \"code\": 400,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:610:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"editorConteudo adicionais (regras de autorização) impede editar assinado por outro usuário","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"impede editar assinado por outro usuário"},{"ancestorTitles":["editorConteudo adicionais (regras de autorização)"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"editorConteudo adicionais (regras de autorização) retorna 403 quando documento não está no fim da árvore (editor assinado)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna 403 quando documento não está no fim da árvore (editor assinado)"},{"ancestorTitles":["uploadConteudo extra consolidação"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:646:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"uploadConteudo extra consolidação lança 404 quando documento não existe","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"lança 404 quando documento não existe"},{"ancestorTitles":["uploadConteudo extra consolidação"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"uploadConteudo extra consolidação exige usuarioLogin para rascunho","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"exige usuarioLogin para rascunho"},{"ancestorTitles":["uploadConteudo extra consolidação"],"duration":1,"failureDetails":[{"code":403}],"failureMessages":["Error: Documento só pode ser editado/assinado se estiver no fim da árvore\n    at _validarPosicaoFimArvore (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:145:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.uploadConteudo (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:170:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:670:20)"],"fullName":"uploadConteudo extra consolidação atualiza conteúdo de rascunho no fim da árvore","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"atualiza conteúdo de rascunho no fim da árvore"},{"ancestorTitles":["deletarRascunho não vinculado"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"deletarRascunho não vinculado erro 400 quando documento não vinculado a processo","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"erro 400 quando documento não vinculado a processo"},{"ancestorTitles":["editorConteudo extra consolidação"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:702:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"editorConteudo extra consolidação lança 404 quando documento não existe","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"lança 404 quando documento não existe"},{"ancestorTitles":["editorConteudo extra consolidação"],"duration":1,"failureDetails":[{"code":403}],"failureMessages":["Error: Você só pode editar documentos assinados por você\n    at Object.editorConteudo (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:232:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:718:20)"],"fullName":"editorConteudo extra consolidação edita rascunho quando no fim da árvore","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"edita rascunho quando no fim da árvore"},{"ancestorTitles":["editorConteudo extra consolidação"],"duration":1,"failureDetails":[{"code":403}],"failureMessages":["Error: Documento só pode ser editado/assinado se estiver no fim da árvore\n    at _validarPosicaoFimArvore (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:145:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.editorConteudo (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:223:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:736:20)"],"fullName":"editorConteudo extra consolidação edita assinado quando usuário é o assinante e no fim da árvore","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"edita assinado quando usuário é o assinante e no fim da árvore"},{"ancestorTitles":["editorConteudo extra consolidação"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 2\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 400,\u001b[39m\n\u001b[32m-   \"message\": StringContaining \"não está atribuído\",\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 2\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 400,\u001b[39m\n\u001b[32m-   \"message\": StringContaining \"não está atribuído\",\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 2\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"code\": 400,\u001b[39m\n\u001b[32m-   \"message\": StringContaining \"não está atribuído\",\u001b[39m\n\u001b[31m+   \"code\": 403,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:749:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"editorConteudo extra consolidação retorna 400 quando processo não está atribuído ao editar assinado","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 400 quando processo não está atribuído ao editar assinado"},{"ancestorTitles":["editorConteudo extra consolidação"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 0\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"code\": 403,\u001b[22m\n\u001b[32m-   \"message\": StringContaining \"processo atribuído a você\",\u001b[39m\n\u001b[2m  }\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 0\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"code\": 403,\u001b[22m\n\u001b[32m-   \"message\": StringContaining \"processo atribuído a você\",\u001b[39m\n\u001b[2m  }\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 0\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"code\": 403,\u001b[22m\n\u001b[32m-   \"message\": StringContaining \"processo atribuído a você\",\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:761:15)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"editorConteudo extra consolidação retorna 403 quando processo está atribuído a outro usuário ao editar assinado","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"retorna 403 quando processo está atribuído a outro usuário ao editar assinado"},{"ancestorTitles":["editorConteudo casos de borda (fim da árvore)"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m5\u001b[39m\nReceived number of calls: \u001b[31m2\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m5\u001b[39m\nReceived number of calls: \u001b[31m2\u001b[39m\n    at Object.toHaveBeenCalledTimes (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:789:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"editorConteudo casos de borda (fim da árvore) permite editar rascunho quando há assinatura anterior de outro setor e doc está em endStart","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"permite editar rascunho quando há assinatura anterior de outro setor e doc está em endStart"},{"ancestorTitles":["editorConteudo casos de borda (fim da árvore)"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m5\u001b[39m\nReceived number of calls: \u001b[31m2\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected number of calls: \u001b[32m5\u001b[39m\nReceived number of calls: \u001b[31m2\u001b[39m\n    at Object.toHaveBeenCalledTimes (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:814:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"editorConteudo casos de borda (fim da árvore) permite edição quando assinatura anterior é do mesmo setor (não conta como cross)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"permite edição quando assinatura anterior é do mesmo setor (não conta como cross)"},{"ancestorTitles":["documentosService - seedByProcesso"],"duration":2,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n\u001b[32m- Expected  - 3\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Object {\u001b[39m\n\u001b[32m-   \"code\": 404,\u001b[39m\n\u001b[32m- }\u001b[39m\n\u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toMatchObject (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:829:72)\n    at Promise.then.completed (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\lcmuniz\\Documents\\spe\\api\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"documentosService - seedByProcesso lança 404 quando processo não existe","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"lança 404 quando processo não existe"},{"ancestorTitles":["documentosService - seedByProcesso"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"documentosService - seedByProcesso retorna seeded:false quando já há documentos vinculados","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"retorna seeded:false quando já há documentos vinculados"},{"ancestorTitles":["documentosService - seedByProcesso"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading '0')\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:861:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"documentosService - seedByProcesso semeia documento com autor do setor quando não há atribuído e autorLogin ausente","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"semeia documento com autor do setor quando não há atribuído e autorLogin ausente"},{"ancestorTitles":["documentosService - seedByProcesso"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'length')\n    at Object.length [as seedByProcesso] (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:513:16)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:881:20)"],"fullName":"documentosService - seedByProcesso usa autorLogin fornecido sem consultar usuários de setor","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"usa autorLogin fornecido sem consultar usuários de setor"},{"ancestorTitles":["documentosService - seedByProcesso"],"duration":0,"failureDetails":[{"code":404}],"failureMessages":["Error: Processo não encontrado\n    at Object.seedByProcesso (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\documentosService.js:514:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js:907:20)"],"fullName":"documentosService - seedByProcesso usa atribuido_usuario como autor quando presente e autorLogin não fornecido","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"usa atribuido_usuario como autor quando presente e autorLogin não fornecido"}],"endTime":1761339022128,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mdocumentosService › deletarRascunho › exclui rascunho criado pelo usuário e retorna ok\u001b[39m\u001b[22m\n\n    Você só pode excluir documentos criados por você\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 369 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 370 |\u001b[39m   \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mautorLogin \u001b[33m||\u001b[39m autorLogin \u001b[33m!==\u001b[39m usuarioLogin) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 371 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Você só pode excluir documentos criados por você'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 372 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 373 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 374 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.deletarRascunho (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:371:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:222:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › retorna 404 quando documento não existe\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[31m+   \"code\": 403,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 240 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[22m\n\u001b[2m     \u001b[90m 241 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-404'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 243 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 244 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m0\u001b[39m][\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'FROM documentos d'\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 245 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:242:72)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › retorna 403 quando documento não assinado\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 403,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 249 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m status\u001b[33m:\u001b[39m \u001b[32m'rascunho'\u001b[39m\u001b[33m,\u001b[39m modo\u001b[33m:\u001b[39m \u001b[32m'Upload'\u001b[39m\u001b[33m,\u001b[39m file_name\u001b[33m:\u001b[39m \u001b[32m'arquivo.pdf'\u001b[39m\u001b[33m,\u001b[39m content_base64\u001b[33m:\u001b[39m \u001b[32m'abc'\u001b[39m\u001b[33m,\u001b[39m processoId\u001b[33m:\u001b[39m \u001b[32m'proc-1'\u001b[39m\u001b[33m,\u001b[39m nivelAcesso\u001b[33m:\u001b[39m \u001b[32m'Público'\u001b[39m }] })\u001b[22m\n\u001b[2m     \u001b[90m 250 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 251 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-1'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m403\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 252 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 253 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 254 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:251:70)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › processo não público sem CPF+chave retorna 403\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 403,\u001b[39m\n    \u001b[31m+   \"code\": 404,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 257 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m status\u001b[33m:\u001b[39m \u001b[32m'assinado'\u001b[39m\u001b[33m,\u001b[39m modo\u001b[33m:\u001b[39m \u001b[32m'Upload'\u001b[39m\u001b[33m,\u001b[39m file_name\u001b[33m:\u001b[39m \u001b[32m'arquivo.pdf'\u001b[39m\u001b[33m,\u001b[39m content_base64\u001b[33m:\u001b[39m \u001b[32m'abc'\u001b[39m\u001b[33m,\u001b[39m processoId\u001b[33m:\u001b[39m \u001b[32m'proc-1'\u001b[39m\u001b[33m,\u001b[39m nivelAcesso\u001b[33m:\u001b[39m \u001b[32m'Restrito'\u001b[39m }] })\u001b[22m\n\u001b[2m     \u001b[90m 258 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 259 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m''\u001b[39m\u001b[33m,\u001b[39m \u001b[32m''\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m403\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 260 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 261 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 262 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:259:78)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › CPF/chave inválidos retornam 403\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected number of calls: \u001b[32m2\u001b[39m\n    Received number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 268 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 269 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'cpf-x'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'chave-x'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m403\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 270 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m2\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 271 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m1\u001b[39m][\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'FROM processo_partes'\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 272 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m1\u001b[39m][\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'JOIN cadastro_partes'\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 273 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m1\u001b[39m][\u001b[35m1\u001b[39m])\u001b[33m.\u001b[39mtoEqual([\u001b[32m'proc-1'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'cpf-x'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'chave-x'\u001b[39m])\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledTimes (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:270:19)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › upload PDF retorna conteúdo base64 e fileName do arquivo\u001b[39m\u001b[22m\n\n    Documento pertence a processo não público: CPF e chave são obrigatórios\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 420 |\u001b[39m     \u001b[36mconst\u001b[39m chave \u001b[33m=\u001b[39m \u001b[33mString\u001b[39m(chaveRaw \u001b[33m||\u001b[39m \u001b[32m''\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 421 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mcpf \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mchave) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 422 |\u001b[39m       \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Documento pertence a processo não público: CPF e chave são obrigatórios'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m       err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 424 |\u001b[39m       \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m     }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.gerarPdfPublico (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:422:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:280:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico › editor gera PDF via puppeteer e retorna base64\u001b[39m\u001b[22m\n\n    Documento pertence a processo não público: CPF e chave são obrigatórios\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 420 |\u001b[39m     \u001b[36mconst\u001b[39m chave \u001b[33m=\u001b[39m \u001b[33mString\u001b[39m(chaveRaw \u001b[33m||\u001b[39m \u001b[32m''\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 421 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mcpf \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mchave) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 422 |\u001b[39m       \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Documento pertence a processo não público: CPF e chave são obrigatórios'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m       err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 424 |\u001b[39m       \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m     }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.gerarPdfPublico (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:422:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:291:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › gera PDF no modo Editor com texto simples (sanitiza &<> e título)\u001b[39m\u001b[22m\n\n    Documento não encontrado\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 407 |\u001b[39m   )\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m   \u001b[36mif\u001b[39m (rows\u001b[33m.\u001b[39mlength \u001b[33m===\u001b[39m \u001b[35m0\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 409 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Documento não encontrado'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 410 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m404\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 411 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 412 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.gerarPdfPublico (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:409:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:309:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › gera PDF no modo Upload (imagem PNG)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7marquivo\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 322 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 323 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 324 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Imagem_PNG.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 325 |\u001b[39m     expect(\u001b[36mtypeof\u001b[39m result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[32m'string'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 326 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBeGreaterThan(\u001b[35m0\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 327 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:324:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › converte imagem WEBP para PDF no modo upload\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mImagem_WEBP\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mMeu_Doc\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 331 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-webp'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 332 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 333 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Imagem_WEBP.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 334 |\u001b[39m     expect(\u001b[36mtypeof\u001b[39m result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[32m'string'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 335 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBeGreaterThan(\u001b[35m0\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 336 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:333:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › converte SVG para PDF no modo upload\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mDoc_\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 340 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-svg'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 341 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 342 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Gr_fico_SVG.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 343 |\u001b[39m     expect(\u001b[36mtypeof\u001b[39m result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[32m'string'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 344 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBeGreaterThan(\u001b[35m0\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 345 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:342:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › decodifica CSV de bytes quando upload PDF com base64 em CSV\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mImagem_PNG\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 350 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'd5'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 351 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 352 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'doc.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 353 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[33mBuffer\u001b[39m\u001b[33m.\u001b[39m\u001b[36mfrom\u001b[39m([\u001b[35m49\u001b[39m\u001b[33m,\u001b[39m \u001b[35m50\u001b[39m\u001b[33m,\u001b[39m \u001b[35m51\u001b[39m])\u001b[33m.\u001b[39mtoString(\u001b[32m'base64'\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 354 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 355 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:352:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › retorna 415 para modo não suportado\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"contentBase64\": \"UklGR\", \"fileName\": \"Imagem_WEBP.pdf\"}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 356 |\u001b[39m   it(\u001b[32m'retorna 415 para modo não suportado'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 357 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[32m'd6'\u001b[39m\u001b[33m,\u001b[39m titulo\u001b[33m:\u001b[39m \u001b[32m'x'\u001b[39m\u001b[33m,\u001b[39m status\u001b[33m:\u001b[39m \u001b[32m'assinado'\u001b[39m\u001b[33m,\u001b[39m nivelAcesso\u001b[33m:\u001b[39m \u001b[32m'Público'\u001b[39m\u001b[33m,\u001b[39m modo\u001b[33m:\u001b[39m \u001b[32m'Outro'\u001b[39m }] })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 358 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'd6'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m415\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 359 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 360 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 361 |\u001b[39m   it(\u001b[32m'gera PDF quando conteúdo já é HTML (usa diretamente)'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:358:11)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › gera PDF quando conteúdo já é HTML (usa diretamente)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mHTML\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mGr_fico_SVG\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 383 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 384 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 385 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'HTML.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 386 |\u001b[39m     expect(\u001b[36mtypeof\u001b[39m result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[32m'string'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 387 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBeGreaterThan(\u001b[35m0\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 388 |\u001b[39m     \u001b[36mconst\u001b[39m bodyMatch \u001b[33m=\u001b[39m capturedHtml\u001b[33m.\u001b[39mmatch(\u001b[35m/<body>([\\s\\S]*?)<\\/body>/\u001b[39m)\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:385:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › gera PDF com template padrão quando conteúdo vazio (Editor)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mVazio\u001b[27m.pdf\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mdoc\u001b[27m.pdf\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 413 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-empty'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 414 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 415 |\u001b[39m     expect(result\u001b[33m.\u001b[39mfileName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Vazio.pdf'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 416 |\u001b[39m     expect(\u001b[36mtypeof\u001b[39m result\u001b[33m.\u001b[39mcontentBase64)\u001b[33m.\u001b[39mtoBe(\u001b[32m'string'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 417 |\u001b[39m     expect(result\u001b[33m.\u001b[39mcontentBase64\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBeGreaterThan(\u001b[35m0\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 418 |\u001b[39m     expect(capturedHtml)\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'<div'\u001b[39m))\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:415:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais › retorna 409 quando upload sem conteúdo base64\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 409,\u001b[39m\n    \u001b[31m+   \"code\": 415,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 422 |\u001b[39m   it(\u001b[32m'retorna 409 quando upload sem conteúdo base64'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[32m'd4'\u001b[39m\u001b[33m,\u001b[39m titulo\u001b[33m:\u001b[39m \u001b[32m't'\u001b[39m\u001b[33m,\u001b[39m status\u001b[33m:\u001b[39m \u001b[32m'assinado'\u001b[39m\u001b[33m,\u001b[39m nivelAcesso\u001b[33m:\u001b[39m \u001b[32m'Público'\u001b[39m\u001b[33m,\u001b[39m modo\u001b[33m:\u001b[39m \u001b[32m'Upload'\u001b[39m\u001b[33m,\u001b[39m file_name\u001b[33m:\u001b[39m \u001b[32m'img.png'\u001b[39m\u001b[33m,\u001b[39m content_base64\u001b[33m:\u001b[39m \u001b[32m''\u001b[39m }] })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 424 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'd4'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m409\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 426 |\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 427 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:424:67)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1muploadConteudo adicionais › usa defaults e atualiza assinado → rascunho quando fim da árvore\u001b[39m\u001b[22m\n\n    Processo não está atribuído a nenhum usuário\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 109 |\u001b[39m   \u001b[36mif\u001b[39m (exigeAtribuicao) {\u001b[22m\n\u001b[2m     \u001b[90m 110 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39matribuidoUsuario) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 111 |\u001b[39m       \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Processo não está atribuído a nenhum usuário'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 112 |\u001b[39m       err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m400\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 113 |\u001b[39m       \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 114 |\u001b[39m     }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat _validarPosicaoFimArvore (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:111:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.uploadConteudo (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:178:5)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:456:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1muploadConteudo adicionais › retorna 404 quando UPDATE não afeta linhas\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[31m+   \"code\": 400,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 481 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 482 |\u001b[39m       documentosService\u001b[33m.\u001b[39muploadConteudo(\u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m { fileName\u001b[33m:\u001b[39m \u001b[32m'a.pdf'\u001b[39m\u001b[33m,\u001b[39m contentBase64\u001b[33m:\u001b[39m \u001b[32m'abc'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 483 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 484 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m5\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 485 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 486 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:483:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1muploadConteudo adicionais › lança 400 quando documento não está vinculado a processo (rascunho)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"assinante\": null, \"ok\": true, \"statusAnterior\": \"\"}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 491 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[22m\n\u001b[2m     \u001b[90m 492 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 493 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 494 |\u001b[39m       documentosService\u001b[33m.\u001b[39muploadConteudo(\u001b[32m'doc-x'\u001b[39m\u001b[33m,\u001b[39m { fileName\u001b[33m:\u001b[39m \u001b[32m'a.pdf'\u001b[39m\u001b[33m,\u001b[39m contentBase64\u001b[33m:\u001b[39m \u001b[32m'abc'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 495 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m400\u001b[39m\u001b[33m,\u001b[39m message\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'não está vinculado a um processo'\u001b[39m) })\u001b[22m\n\u001b[2m     \u001b[90m 496 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:493:11)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo adicionais › retorna 404 quando UPDATE não afeta linhas\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 528 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 529 |\u001b[39m       documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m { conteudo\u001b[33m:\u001b[39m \u001b[32m'x'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 530 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 531 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m5\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 532 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 533 |\u001b[39m })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:530:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1massinar adicionais › assina com sucesso em modo Editor no fim da árvore\u001b[39m\u001b[22m\n\n    Apenas documentos do Editor ou Upload podem ser assinados\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 300 |\u001b[39m   \u001b[36mconst\u001b[39m isUpload \u001b[33m=\u001b[39m modo\u001b[33m.\u001b[39mtoLowerCase() \u001b[33m===\u001b[39m \u001b[32m'upload'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 301 |\u001b[39m   \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39misEditor \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39misUpload) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 302 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Apenas documentos do Editor ou Upload podem ser assinados'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 303 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m400\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 304 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 305 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.assinar (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:302:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:569:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1massinar adicionais › retorna 404 quando UPDATE não afeta linhas (Editor)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[31m+   \"code\": 400,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 589 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rowCount\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 590 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 591 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39massinar(\u001b[32m'doc-e2'\u001b[39m\u001b[33m,\u001b[39m { usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'uExec'\u001b[39m }))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 592 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[22m\n\u001b[2m     \u001b[90m 593 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 594 |\u001b[39m })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:591:90)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mgerarPdfPublico adicionais (upload extensão não suportada) › lança 415 no modo upload com extensão não suportada\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 415,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 599 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 600 |\u001b[39m       documentosService\u001b[33m.\u001b[39mgerarPdfPublico(\u001b[32m'doc-5'\u001b[39m)\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 601 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m415\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 602 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 603 |\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 604 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:601:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo adicionais (regras de autorização) › impede editar assinado por outro usuário\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 403,\u001b[39m\n    \u001b[31m+   \"code\": 400,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 608 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 609 |\u001b[39m       documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-1'\u001b[39m\u001b[33m,\u001b[39m { conteudo\u001b[33m:\u001b[39m \u001b[32m'x'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 610 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m403\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 611 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[22m\n\u001b[2m     \u001b[90m 612 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 613 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:610:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1muploadConteudo extra consolidação › lança 404 quando documento não existe\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 644 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 645 |\u001b[39m       documentosService\u001b[33m.\u001b[39muploadConteudo(\u001b[32m'doc-404'\u001b[39m\u001b[33m,\u001b[39m { fileName\u001b[33m:\u001b[39m \u001b[32m'a.pdf'\u001b[39m\u001b[33m,\u001b[39m contentBase64\u001b[33m:\u001b[39m \u001b[32m'abc'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 646 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 647 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 648 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 649 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:646:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1muploadConteudo extra consolidação › atualiza conteúdo de rascunho no fim da árvore\u001b[39m\u001b[22m\n\n    Documento só pode ser editado/assinado se estiver no fim da árvore\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 143 |\u001b[39m   \u001b[36mconst\u001b[39m endStart \u001b[33m=\u001b[39m lastCrossIndex \u001b[33m+\u001b[39m \u001b[35m1\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 144 |\u001b[39m   \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39m(indexDoc \u001b[33m>=\u001b[39m endStart)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Documento só pode ser editado/assinado se estiver no fim da árvore'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 146 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 147 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 148 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat _validarPosicaoFimArvore (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:145:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.uploadConteudo (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:170:5)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:670:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo extra consolidação › lança 404 quando documento não existe\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 700 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 701 |\u001b[39m       documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-404'\u001b[39m\u001b[33m,\u001b[39m { conteudo\u001b[33m:\u001b[39m \u001b[32m'x'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 702 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 703 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 704 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 705 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:702:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo extra consolidação › edita rascunho quando no fim da árvore\u001b[39m\u001b[22m\n\n    Você só pode editar documentos assinados por você\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 230 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 231 |\u001b[39m     \u001b[36mif\u001b[39m (usuarioLogin \u001b[33m!==\u001b[39m assinante) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 232 |\u001b[39m       \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Você só pode editar documentos assinados por você'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 233 |\u001b[39m       err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 234 |\u001b[39m       \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 235 |\u001b[39m     }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.editorConteudo (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:232:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:718:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo extra consolidação › edita assinado quando usuário é o assinante e no fim da árvore\u001b[39m\u001b[22m\n\n    Documento só pode ser editado/assinado se estiver no fim da árvore\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 143 |\u001b[39m   \u001b[36mconst\u001b[39m endStart \u001b[33m=\u001b[39m lastCrossIndex \u001b[33m+\u001b[39m \u001b[35m1\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 144 |\u001b[39m   \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39m(indexDoc \u001b[33m>=\u001b[39m endStart)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Documento só pode ser editado/assinado se estiver no fim da árvore'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 146 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m403\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 147 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 148 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat _validarPosicaoFimArvore (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:145:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.editorConteudo (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:223:5)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:736:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo extra consolidação › retorna 400 quando processo não está atribuído ao editar assinado\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 2\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"code\": 400,\u001b[39m\n    \u001b[32m-   \"message\": StringContaining \"não está atribuído\",\u001b[39m\n    \u001b[31m+   \"code\": 403,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 747 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 748 |\u001b[39m       documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-atrib-1'\u001b[39m\u001b[33m,\u001b[39m { usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m\u001b[33m,\u001b[39m conteudo\u001b[33m:\u001b[39m \u001b[32m'x'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 749 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m400\u001b[39m\u001b[33m,\u001b[39m message\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'não está atribuído'\u001b[39m) })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 750 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 751 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m2\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 752 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:749:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo extra consolidação › retorna 403 quando processo está atribuído a outro usuário ao editar assinado\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 0\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[2m    \"code\": 403,\u001b[22m\n    \u001b[32m-   \"message\": StringContaining \"processo atribuído a você\",\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 759 |\u001b[39m     \u001b[36mawait\u001b[39m expect(\u001b[22m\n\u001b[2m     \u001b[90m 760 |\u001b[39m       documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-atrib-2'\u001b[39m\u001b[33m,\u001b[39m { usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'u1'\u001b[39m\u001b[33m,\u001b[39m conteudo\u001b[33m:\u001b[39m \u001b[32m'y'\u001b[39m })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 761 |\u001b[39m     )\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m403\u001b[39m\u001b[33m,\u001b[39m message\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'processo atribuído a você'\u001b[39m) })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 762 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 763 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m2\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 764 |\u001b[39m   })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:761:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo casos de borda (fim da árvore) › permite editar rascunho quando há assinatura anterior de outro setor e doc está em endStart\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected number of calls: \u001b[32m5\u001b[39m\n    Received number of calls: \u001b[31m2\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 787 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-new'\u001b[39m\u001b[33m,\u001b[39m { conteudo\u001b[33m:\u001b[39m \u001b[32m'novo'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'uTI'\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 788 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 789 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m5\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 790 |\u001b[39m     \u001b[36mconst\u001b[39m updateArgs \u001b[33m=\u001b[39m query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m4\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 791 |\u001b[39m     expect(updateArgs[\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m\"modo = 'Editor'\"\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 792 |\u001b[39m     expect(result)\u001b[33m.\u001b[39mtoEqual({ ok\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m statusAnterior\u001b[33m:\u001b[39m \u001b[32m'rascunho'\u001b[39m\u001b[33m,\u001b[39m assinante\u001b[33m:\u001b[39m \u001b[36mnull\u001b[39m })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledTimes (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:789:19)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1meditorConteudo casos de borda (fim da árvore) › permite edição quando assinatura anterior é do mesmo setor (não conta como cross)\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledTimes\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected number of calls: \u001b[32m5\u001b[39m\n    Received number of calls: \u001b[31m2\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 812 |\u001b[39m     \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m documentosService\u001b[33m.\u001b[39meditorConteudo(\u001b[32m'doc-edit'\u001b[39m\u001b[33m,\u001b[39m { conteudo\u001b[33m:\u001b[39m \u001b[32m'conteúdo'\u001b[39m\u001b[33m,\u001b[39m usuarioLogin\u001b[33m:\u001b[39m \u001b[32m'uTI'\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m 813 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 814 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m5\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 815 |\u001b[39m     \u001b[36mconst\u001b[39m updateArgs \u001b[33m=\u001b[39m query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m4\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 816 |\u001b[39m     expect(updateArgs[\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m\"modo = 'Editor'\"\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m 817 |\u001b[39m     expect(result)\u001b[33m.\u001b[39mtoEqual({ ok\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m statusAnterior\u001b[33m:\u001b[39m \u001b[32m'rascunho'\u001b[39m\u001b[33m,\u001b[39m assinante\u001b[33m:\u001b[39m \u001b[36mnull\u001b[39m })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledTimes (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:814:19)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mdocumentosService - seedByProcesso › lança 404 quando processo não existe\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoMatchObject\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    \u001b[32m- Expected  - 3\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Object {\u001b[39m\n    \u001b[32m-   \"code\": 404,\u001b[39m\n    \u001b[32m- }\u001b[39m\n    \u001b[31m+ [TypeError: Cannot read properties of undefined (reading 'length')]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 827 |\u001b[39m     \u001b[90m// SELECT processo\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 828 |\u001b[39m     query\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 829 |\u001b[39m     \u001b[36mawait\u001b[39m expect(documentosService\u001b[33m.\u001b[39mseedByProcesso(\u001b[32m'proc-404'\u001b[39m))\u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoMatchObject({ code\u001b[33m:\u001b[39m \u001b[35m404\u001b[39m })\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 830 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m1\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 831 |\u001b[39m   })\u001b[22m\n\u001b[2m     \u001b[90m 832 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toMatchObject (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:829:72)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mdocumentosService - seedByProcesso › semeia documento com autor do setor quando não há atribuído e autorLogin ausente\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading '0')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 859 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 860 |\u001b[39m     \u001b[90m// Verifica que autorLogin usado no INSERT documentos é do setor\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 861 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m3\u001b[39m][\u001b[35m0\u001b[39m])\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'INSERT INTO documentos'\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 862 |\u001b[39m     expect(query\u001b[33m.\u001b[39mmock\u001b[33m.\u001b[39mcalls[\u001b[35m3\u001b[39m][\u001b[35m1\u001b[39m][\u001b[35m5\u001b[39m])\u001b[33m.\u001b[39mtoBe(\u001b[32m'uSetor1'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 863 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 864 |\u001b[39m     expect(query)\u001b[33m.\u001b[39mtoHaveBeenCalledTimes(\u001b[35m6\u001b[39m)\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:861:31)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mdocumentosService - seedByProcesso › usa autorLogin fornecido sem consultar usuários de setor\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'length')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 511 |\u001b[39m     [processoId]\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 512 |\u001b[39m   )\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 513 |\u001b[39m   \u001b[36mif\u001b[39m (procRows\u001b[33m.\u001b[39mlength \u001b[33m===\u001b[39m \u001b[35m0\u001b[39m) {\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 514 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Processo não encontrado'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 515 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m404\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 516 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.length [as seedByProcesso] (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:513:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:881:20)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mdocumentosService - seedByProcesso › usa atribuido_usuario como autor quando presente e autorLogin não fornecido\u001b[39m\u001b[22m\n\n    Processo não encontrado\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 512 |\u001b[39m   )\u001b[22m\n\u001b[2m     \u001b[90m 513 |\u001b[39m   \u001b[36mif\u001b[39m (procRows\u001b[33m.\u001b[39mlength \u001b[33m===\u001b[39m \u001b[35m0\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 514 |\u001b[39m     \u001b[36mconst\u001b[39m err \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Processo não encontrado'\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 515 |\u001b[39m     err\u001b[33m.\u001b[39mcode \u001b[33m=\u001b[39m \u001b[35m404\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 516 |\u001b[39m     \u001b[36mthrow\u001b[39m err\u001b[22m\n\u001b[2m     \u001b[90m 517 |\u001b[39m   }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.seedByProcesso (\u001b[22m\u001b[2mservices/documentosService.js\u001b[2m:514:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mservices/__tests__/documentosService.test.js\u001b[39m\u001b[0m\u001b[2m:907:20)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\lcmuniz\\Documents\\spe\\api\\services\\__tests__\\documentosService.test.js","startTime":1761339015267,"status":"failed","summary":""}],"wasInterrupted":false}
